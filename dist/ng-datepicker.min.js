"use strict";function CalendarController(a,b,c,d,e){this.id="calCtrl",this.selected=null,this.today=moment(),this.viewDate=moment(),this.startOfWeek=0,this.options={},this.years=[],this.year=this.viewDate.year(),this.month=this.viewDate.month(),this.isToday=function(a){return a.isSame(this.today,"day")},this.isCurrentMonth=function(a){return a.month()===this.viewDate.month()},this.isWeekend=function(a){return a.isoWeekday()>5},this.isSelected=function(a){return a.isSame(this.selected,"day")},this.isHighlighted=function(a){return this.highlightCallback?this.highlightCallback(a):!1},this.setDate=function(a){this.viewDate=a.clone(),this.updateSelectValues(a)},this.reset=function(){moment.isMoment(this.selected)?this.viewDate=this.selected.clone():this.viewDate=moment(),this.updateSelectValues(),a.$apply()},this.updateSelectValues=function(a){a=a||this.viewDate,this.month=this.options.months[a.month()],this.year=a.year()};var f=function(a,b,c){if(0===b)throw"Quit jogging in place!!";return b>0?a.add(b,c):a.subtract(Math.abs(b),c),this.updateSelectValues(a),a}.bind(this);this.jogMonth=function(a){return f(this.viewDate,a,"months")},this.jogYear=function(a){return f(this.viewDate,a,"years")},this.select=function(b){this.selected=b,a.selectCallback&&a.selectCallback({date:b.clone()}),this.selected=b.clone(),this.viewDate=b.clone(),this.updateSelectValues()},this.updateCalendar=function(){var a,b,c,d=[],e=this.viewDate.clone().startOf("month");for(e.subtract(Math.abs(e.isoWeekday()-this.startOfWeek),"day"),a=0;6>a;a++)d[a]=[];for(a=0,b=0,c=0;42>a;a++,b++)a>0&&b%7===0&&(b=0,c++),d[c][b]=e.clone(),e.add(1,"day");this.calendar=d},this.setup=function(a){this.options=a,this.options.years=[];for(var b=this.options.yearStart;b<this.viewDate.year()+10;b++)this.options.years.push(b)},a.$watch("calCtrl.month",function(a,b){a!==b&&(this.viewDate.month(this.options.months.indexOf(this.month)),this.updateCalendar())}.bind(this)),a.$watch("calCtrl.year",function(){this.viewDate.year(this.year),this.updateCalendar()}.bind(this));var g=function(){this.updateCalendar()}.bind(this);g()}function DatePickerController(a,b,c,d,e){this.id="dateCtrl",this.selectedDate={},this.viewDate={},this.options={},this.isHighlighted=function(a){return scope.range===!0?a>this.viewDate.startDate||a<this.viewDate.endDate:!1},this.hasRanges=function(){return this.options.ranges&&this.options.ranges.length>0},this.isRange=function(){return this.options.range},this.setup=function(a){this.options=a}}function DatePicker(a,b,c,d,e){c=angular.extend({monthLeftIcon:"fa fa-angle-left",yearLeftIcon:"fa fa-angle-double-left",monthRightIcon:"fa fa-angle-right",yearRightIcon:"fa fa-angle-double-right",range:!1,time:!1,timeFormat:"HH:mm:ss",format:"YYYY/MM/DD",position:"bottomleft",dateSelect:!0,daysOfWeek:moment.weekdaysShort(),months:moment.months(),yearStart:1990,autoHide:!0},c||{});var f=!1;this.options=function(){return c},this.show=function(){f||(b.show(),this.position(),this.isShowing=!0)},this.hide=function(){this.isShowing&&(angular.element(d).off(".e7datepicker"),angular.element(d.document).off("e7datepicker"),b.hide(),this.isShowing=!1)},this.toggle=function(a){this.isShowing?this.hide():this.show()},this.position=function(a){var c={top:0,right:"auto",left:0};c.top=h(),angular.extend(c,g()),b.css(c)};var g=function(){var e={},f=6;switch("top"===c.position.substr(0,3)&&(f=3),c.position.substr(f)){case"left":e={right:"auto",left:a.offset().left};break;case"center":e={left:a.outerWidth()/2-b.outerWidth()/2+(a.outerWidth()-a.innerWidth())+a.offset().left};break;default:var g=b.offset().left+b.outerWidth()>angular.element(d).width();e={left:g?"auto":a.offset().left+(a.outerWidth()-b.outerWidth()),right:g?0:"auto"},g&&(e.right=0)}return e}.bind(this),h=function(){b.addClass("dropup");var e=a.offset().top-b.outerHeight(),f=a.offset().top+a.outerHeight()+b.outerHeight()>angular.element(d).innerHeight(),g=a.offset().top-b.outerHeight()<0;return("bottom"===c.position.substr(0,6)&&!f||g)&&(b.removeClass("dropup"),e=a.offset().top+a.outerHeight()),e}.bind(this),i=function(){this.position(),$(window).on("resize.e7datepicker",$.proxy(function(a){this.position(a)},this)),angular.element(d.document).on("focusin.e7datepicker click.e7datepicker mousedown.e7datepicker touchend.e7datepicker mouseup.e7datepicker [data-toggle=dropdown]",$.proxy(function(c){var d=angular.element(c.target);0===d.closest(a).length&&0===d.closest(b).length&&0===d.closest(".calendar-table").length&&(e.$broadcast("reset.calendar."+e.name),this.hide())}.bind(this),this))}.bind(this);i()}CalendarController.$inject=["$scope","$element","$attrs","$transclude","$log"],DatePickerController.$inject=["$scope","$element","$attrs","$transclude","$log"],angular.module("e7datepicker",[]).directive("e7datepicker",["$templateCache","$compile","$window","$log",function(a,b,c,d){return{require:["ngModel"],restrict:"A",controller:DatePickerController,controllerAs:"dateCtrl",scope:{name:"@e7datepicker",options:"@"},link:function(d,e,f,g){d.options=d.options||{};var h=g[0],i=d.dateCtrl,j=e,k=angular.element(b(a.get("ngdatetimepicker/datepicker.html"))(d));k.appendTo("body");var l=new DatePicker(j,k,d.options,c,d);i.setup(l.options()),j.on("click.e7datepicker",function(){l.show()}),i.selectStart=function(a){if(!moment.isMoment(a))throw"selected date must be a moment instance not "+typeof a;i.selectedDate=a,h.$setViewValue(a),h.$render(),i.options.autoHide&&k.hide()},i.selectEnd=function(a){if(!moment.isMoment(a))throw"selected date must be a moment instanct not "+typeof a;i.selectedDate.end=i.rightDate,h.$setViewValue(i.selectedDate.clone())},h.$parsers.push(function(a){if(!moment.isMoment(a)){var b=moment(a,m(),!0);a=b.isValid()?b:i.selectedDate}return i.selectedDate=a,i.leftDate=a,a}),h.$render=function(){if(i.options.range===!0&&moment.isMoment(i.selectedDate.start))j.val(i.selectedDate.format(m()));else if(moment.isMoment(h.$viewValue))i.selectedDate=h.$viewValue.clone(),j.val(h.$viewValue.format(m()));else if(moment.isMoment(h.$modelValue))j.val(h.$modelValue.format(m())),i.selectedDate=h.$modelValue,i.leftDate=h.$modelValue;else if(moment.isMoment(i.selectedDate))j.val(i.selectedDate.format(m()));else if("string"==typeof h.$modelValue){var a=moment(h.$modelValue,m());a.isValid()&&(i.selectedDate=a,i.leftDate=a,j.val(a.format(m())))}};var m=function(a){var b=i.options.format;return i.options.time&&!a&&(b+=" "+i.options.timeFormat),b}}}}]).directive("ngCalendar",["$templateCache","$compile","$window","$log","$parse",function(a,b,c,d,e){return{restrict:"E",priority:1,templateUrl:"ngdatetimepicker/calendar.html",controller:CalendarController,controllerAs:"calCtrl",scope:{name:"@",highlightCallback:"&",selectCallback:"&",options:"=",dateSelected:"="},link:function(a,b,c,d){var e=(d[0],a.calCtrl);a.options=a.options||{},e.setup(a.options),a.$watch("dateSelected",function(a){if(angular.isDefined(a)||(a=moment()),!moment.isMoment(a)){if(null===a)return;throw"Calendar expects value to be a moment not "+typeof a+" "+a}var b=a.clone();e.setDate(b),e.selected=b}),a.$on("reset.calendar."+a.name.slice(0,a.name.indexOf("-")),function(a){e.reset()})}}}]);